require('dotenv').config({ path: '../../.env' });
const mongoose = require('mongoose');
const async = require('async');
const _ = require('underscore');

const beastSchema = require('../../schemes/beast');

const Beast = mongoose.model('Beast', beastSchema);

mongoose.connect('mongodb://heroku_1q54zt8s:8kbg65u9g98hol9dgithpujahv@ds119490.mlab.com:19490/heroku_1q54zt8s');

const minMax = (array) => {
  const min = _.min(array);
  const max = _.max(array);

  if (min !== max) {
    return `${min}-${max}`;
  }

  return `${min}`;
};

const beastList = [
  'ðŸ˜ˆÐšÑ€Ð¾Ð²Ð¾ÑÐ¾Ñ (ÐÐ¾Ð²Ð¾Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð½Ñ‹Ð¹)',
  'ðŸ¦‡Ð’Ð°Ð¼Ð¿Ð¸Ñ€ (Ð¡Ð¸Ð½Ñ‚)',
  'ðŸ¦‡Ð’Ð°Ð¼Ð¿Ð¸Ñ€ (Ð’Ñ‹Ð½ÑƒÐ¶Ð´ÐµÐ½ ÑÐ¾ÑÐ°Ñ‚ÑŒ)',
  'ðŸ‘»ÐŸÑ€Ð¸Ð·Ñ€Ð°Ðº (ÐÐ°Ð¶Ð°Ð» Alt+F4)',
  'ðŸ‘»ÐŸÑ€Ð¸Ð·Ñ€Ð°Ðº (ðŸ”±Ð”ÑƒÑ… Ð¼Ð°Ñ€Ð¾Ð´Ñ‘Ñ€Ð°)',
  'ðŸ‘»ÐŸÑ€Ð¸Ð·Ñ€Ð°Ðº (ÐŸÐ¾Ð½ÑÐ», Ñ‡Ñ‚Ð¾ ÐµÐ³Ð¾ Ð½Ð°ÐµÐ±Ð°Ð»Ð¸)',
  'ðŸ’€Ð ÐµÐ¹Ð´ÐµÑ€ Ð±ÐµÐ· Ð³Ð¾Ð»Ð¾Ð²Ñ‹ (ÐŸÑ€Ð¸Ð¼ÐµÑ€ÑÐ» Ð±Ñ‹ Ñ‚Ð²Ð¾ÑŽ)',
  'ðŸ¤ Ð’Ð°Ð½-Ð¥ÐµÐ»ÑŒÑÐ¸Ð½Ð³ (Ð’ Ð¿Ð¾Ð¸ÑÐºÐ°Ñ… Ñ‡ÑƒÐ´Ð¸Ñ‰)',
  'ï¿½ÐœÐµÑ€Ñ‚Ð²ÐµÑ† (ðŸµÐ‘Ð»ÐµÐ´Ð½Ñ‹Ð¹)',
  'ðŸ§Ÿâ€â™‚ï¸Ð—Ð¾Ð¼Ð±Ð¸ (ðŸµðŸµÐ ÐµÐ¹Ð´ÐµÑ€ Ðº ÑƒÑÐ¿ÐµÑ…Ñƒ ÑˆÑ‘Ð»)',
  '?â€â™‚ï¸Ð”Ñ€Ð°ÐºÑƒÐ»Ð° (Ð¥Ð¾Ð·ÑÐ¸Ð½ Ð“ÐµÐ½Ñ€Ð¸ Ð­Ð´ÐµÐ¼Ð°)',
  'ðŸ¦‹Ð‘Ð»ÑƒÐ¶Ð´Ð°ÑŽÑ‰Ð¸Ð¹ Ð¾Ð³Ð¾Ð½Ñ‘Ðº (ÐœÐ°Ð½Ð¸Ñ‚ Ðº ÑÐµÐ±Ðµ)',
  'ðŸ‡»ðŸ‡¦Ð’Ð¾Ð¸Ð½ Ð–Ñ‘Ð»Ñ‚Ð¾Ð³Ð¾ Ð·Ð°Ð¼ÐºÐ° (Ð§Ñ‚Ð¾ Ð¾Ð½ Ð·Ð´ÐµÑÑŒ Ð·Ð°Ð±Ñ‹Ð», Ð±Ð»ÑÐ´ÑŒ?)',
  'ðŸ±ÐÐµÑ‡Ñ‚Ð¾ (ÐœÐ¸Ð¼Ð¸ÐºÑ€Ð¸Ñ€ÑƒÐµÑ‚ Ð¿Ð¾Ð´ ÐºÐ¾Ñ‚Ñ‘Ð½ÐºÐ°)',
  'ðŸ¦‰Ð¡Ð¾Ð²Ð°-Ð»ÑŽÐ´Ð¾ÐµÐ´ (Ð¦ÐµÐ»Ð¸Ñ‚ÑÑ Ð² Ð³Ð»Ð°Ð·Ð°)',
  'ðŸ¤¹ðŸ¼â€â™€ï¸ÐšÐ°Ñ€Ð»Ð¸Ðº (Ð¡Ð±ÐµÐ¶Ð°Ð» Ð¸Ð· Ñ†Ð¸Ñ€ÐºÐ°)',
  'ðŸŽ­ÐšÐ¾Ð»Ð»ÐµÐºÑ†Ð¸Ð¾Ð½ÐµÑ€ (ðŸ”±ðŸ”±Ð¦ÐµÐ½Ð¸Ñ‚ Ñ‚Ð²Ð¾ÑŽ Ð¶Ð¸Ð·Ð½ÑŒ Ð±Ð¾Ð»ÑŒÑˆÐµ Ñ‡ÐµÐ¼ Ñ‚Ñ‹)',
  'ðŸ‘¨ðŸ»â€ðŸ«Ð”Ð¾ÐºÑ‚Ð¾Ñ€ Ð”Ð¶ÐµÐºÐ¸Ð»Ð» (ÐŸÑ€Ð¸ÑÑ‚Ð½Ñ‹Ð¹ Ð¼Ð¾Ð»Ð¾Ð´Ð¾Ð¹ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº)',
  'ðŸµÐœÐ¸ÑÑ‚ÐµÑ€ Ð¥Ð°Ð¹Ð´ (ðŸ”±ÐÐµÐ¿Ñ€Ð¸ÑÑ‚Ð½Ñ‹Ð¹ Ð¼Ð¾Ð»Ð¾Ð´Ð¾Ð¹ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº)',
  'ðŸ‘¦ðŸ»Ð”ÑÐ¼Ð¸ÐµÐ½ (ðŸ”±ÐžÑ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ Ð²Ñ€Ð°Ñ‚Ð° Ð² Ð°Ð´)',
  'ðŸ’©Ð”ÐµÑ€ÑŒÐ¼Ð¾Ð´ÐµÐ¼Ð¾Ð½ (Ð”ÐµÐ»Ð°ÐµÑ‚ ÑÑƒÑ‰ÐµÐµ Ð·Ð»Ð¾Ð²Ð¾Ð½Ð½Ð¾Ð¹ ÐºÐ»Ð¾Ð°ÐºÐ¾Ð¹)',
  'ðŸ”ªÐ”Ð¶ÐµÐ¹ÑÐ¾Ð½ (ðŸµðŸµÐÐ°Ð¼ÐµÑ€ÐµÐ²Ð°ÐµÑ‚ÑÑ Ð¾Ñ‚Ð¾Ð¼ÑÑ‚Ð¸Ñ‚ÑŒ)',
  'ðŸ‘ºÐœÐ°ÑÐºÐ° (Ð—Ð²Ð¾Ð½Ð¸Ñ‚ Ð½Ð° Ñ‚Ð²Ð¾Ð¹ Ð¿Ð¸Ð¿-Ð±Ð¾Ð¹)',
  'ðŸ‘ºÐœÐ°ÑÐºÐ° (Ð˜Ñ‰ÐµÑ‚ Ð¡Ð¸Ð´Ð½Ð¸ ÐŸÑ€ÐµÑÐºÐ¾Ñ‚Ñ‚)',
  'ðŸ¦ˆÐœÐµÐ³Ð°Ð»Ð¾Ð´Ð¾Ð½ (Ð‘Ð°Ñ€Ð°Ñ…Ñ‚Ð°ÐµÑ‚ÑÑ Ð² Ð¿ÐµÑÐºÐµ)',
  'ðŸ‘¹Ð¥Ð¸Ñ‰Ð½Ð¸Ðº (Ð˜Ñ‰ÐµÑ‚ Ñ‡ÑƒÐ¶Ð¾Ð³Ð¾)',
  'ðŸ›Ð§ÑƒÐ¶Ð¾Ð¹ (Ð˜Ñ‰ÐµÑ‚ Ñ…Ð¸Ñ‰Ð½Ð¸ÐºÐ°)',
  'ðŸ´Ð¤Ñ€ÐµÐ´Ð´Ð¸ ÐšÑ€ÑŽÐ³Ð³ÐµÑ€ (Ð˜Ñ‰ÐµÑ‚ ÑƒÐ»Ð¸Ñ†Ñƒ Ð’ÑÐ·Ð¾Ð²)',
  'ðŸ‘¤ÐœÐ°Ð¹ÐºÐ» ÐœÐ°Ð¹ÐµÑ€Ñ (Ð’Ð¸Ð½Ð¾Ð²Ð½Ð¸Ðº ÑÑ‚Ð¾Ð³Ð¾ Ñ‚Ð¾Ñ€Ð¶ÐµÑÑ‚Ð²Ð°)',
  'ðŸ¤–ÐÐ»ÑŒÑ‚Ñ€Ð¾Ð½ (ÐŸÐ¾ÑÐµÐ»Ð¸Ð»ÑÑ Ð² Ñ‚Ð²Ð¾ÐµÐ¼ Ð¿Ð¸Ð¿-Ð±Ð¾Ðµ)',
  'ðŸ¤•ÐšÐ¾Ð¶Ð°Ð½Ð¾Ðµ Ð»Ð¸Ñ†Ð¾ (ðŸ”±ðŸ”±ÐŸÑ€Ð¸Ð²ÐµÑ‚Ð»Ð¸Ð²Ð¾ Ð¼Ð°ÑˆÐµÑ‚ Ð±ÐµÐ½Ð·Ð¾Ð¿Ð¸Ð»Ð¾Ð¹)',
  'ðŸ¤¡ÐŸÐµÐ½Ð½Ð¸Ð²Ð°Ð¹Ð· (Ð¡ÑŠÐµÐ» Ñ‚Ð²Ð¾ÐµÐ³Ð¾ Ð±Ñ€Ð°Ñ‚Ð°)',
];

console.log('===START===');

async.forEach(beastList, (name, next) => {
  Beast.find({
    name,
    subType: 'regular',
  }).then((beasts) => {
    if (beasts.length === 0) {
      console.log(`${name} - Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½ Ð² Ð±Ð°Ð·Ðµ`);
      console.log('===========================');
      next();
    } else {
      console.log(`${name}:`);

      async.forEach(beasts, (beast, _next) => {
        const ranges = `${beast.type === 'DarkZone' ? 'ðŸš·' : 'ðŸ’€'} ${minMax(beast.distanceRange.map(({ value }) => value))}`;
        console.log(ranges.length > 0 ? ranges : 'ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¾ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ðµ');
        _next();
      }, () => {
        next();
        console.log('===========================');
      });
    }
  });
}, () => {
  mongoose.disconnect();
  console.log('===END===');
});
